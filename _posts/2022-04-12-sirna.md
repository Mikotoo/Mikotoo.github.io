---
title: siRNA数据分析步骤
author: 
date: 2022-04-12
category: Jekyll
layout: post
---

> Small RNA，指长度小于200bp的RNA序列，通常不能翻译为蛋白，但在基因表达的调控中起作用。<br>
一般而言，小RNA可以分为miRNA, piRNA, siRNA, snRNA, snoRNA, rRNA, tRNA等。<br>
sRNA-seq没有固定的pipeline，根据具体需求有不同的分析步骤。**本文整理了siRNA的处理流程**。<br>

____

所需软件：fastqc fastp blast+ bowtie mirdeep2

以我的数据为例:<br>
工作目录`/pub4/zhangchao/Methylome_Soybean/sRNA-seq`

![pic1][1]<br>

原始数据存放在`fastq/raw_data`中：<br>
>5个样本，每个样本两个重复，单端测序

![pic2][2]<br>

脚本文件位于`scripts`目录


1、原始数据质控
-------------
使用fastqc对原始数据质控，代码如下:<br>
`raw_fastqc.sh`
```
#!/bin/sh
# rawdata fastqc
if [ -d ~/Methylome_Soybean/sRNA-seq/fastq/rwa_data/fastqc]
then
    echo "fastqc directory has existed."
else
    mkdir ~/Methylome_Soybean/sRNA-seq/fastq/rwa_data/fastqc
    echo "fastqc directory is newly created."
fi
cd ~/Methylome_Soybean/sRNA-seq/fastq/raw_data
ls *fastq | cut -d . -f 1 |while read id;
do
fastqc -i ${id}.fastq -o ./fastqc
done
```

部分结果如下：

![pic3][3]
![pic4][4]
![pic5][5]

可见拿到的数据质量已经很高了，并且adapter也已经去除。<br>
接下来主要对reads长度进行筛选

2、质量过滤
----------
使用fastp进行筛选，代码如下：<br>
`fastp.sh`
```
#!/bin/bash
# fastp
if [ -d ~/Methylome_Soybean/sRNA-seq/fastq/clean_data ]
then
    echo "clean_data directory has existed."
else
    mkdir ~/Methylome_Soybean/sRNA-seq/fastq/clean_data
    echo "clean_data directory is newly created."
fi
cd ~/Methylome_Soybean/sRNA-seq/fastq/raw_data
ls *fastq | cut -d . -f 1 |while read id;
do
fastp -i ${id}.fastq \
-o ../clean_data/${id}_clean.fastq \
-q 20 -u 20 \   #reads中，超过20%的碱基质量低于20则切除
-5 -3 \         #两端滑窗，默认4bp，质量低于20则切除
-A \            #这个参数意思是跳过去接头的步骤，不加则自动去接头，-a 可以指定接头
--length_required 18 \  #过滤掉小于18bp的reads
--length_limit 30       #过滤掉大于30bp的reads
done

#对过滤后的clean reads进行二次质控
if [ -d ~/Methylome_Soybean/sRNA-seq/fastq/clean_data/clean_fastqc]
then
    echo "clean_fastqc directory has existed."
else
    mkdir ~/Methylome_Soybean/sRNA-seq/fastq/clean_data/clean_fastqc
    echo "clean_fastqc directory is newly created."
cd ~/Methylome_Soybean/sRNA-seq/fastq/clean_data
ls *clean_fastq | cut -d . -f 1 |while read id;
do
fastqc -i ${id}.fastq -o ./clean_fastqc
done
```

3、过滤掉已知的其它小RNA
---------------------
小RNA测序得到的reads中也包含了许多其它小RNA，如rRNA, tRNA, snRNA, miRNA等，需要将这些序列去除。<br>
我们从[**Rfam**][https://rfam.xfam.org/]和[**RNAcentral**][https://rnacentral.org/]下载已注释的小RNA序列，用blast方法将它们筛除，剩余的序列进行下一步分析。

###  3.1 小RNA库下载
#### 3.1.1 Rfam库
创建 `~/Methylation_soyeban/sRNA_seq/rfam`目录，下载Rfam库的所有fasta文件并解压










[1]: https://github.com/Mikotoo/Mikotoo.github.io/raw/main/downloads/image/blog2_sirna/srna_1.png
[2]: https://github.com/Mikotoo/Mikotoo.github.io/raw/main/downloads/image/blog2_sirna/srna_2.png
[3]: https://github.com/Mikotoo/Mikotoo.github.io/raw/main/downloads/image/blog2_sirna/raw_fastqc_1.png
[4]: https://github.com/Mikotoo/Mikotoo.github.io/raw/main/downloads/image/blog2_sirna/raw_fastqc_2.png
[5]: https://github.com/Mikotoo/Mikotoo.github.io/raw/main/downloads/image/blog2_sirna/raw_fastqc_3.png